---
title: Chat
layout: null
permalink: /chat/
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="dark" />
    <title>Patterns of Change</title>

    {% include analytics/goatcounter.html %}

    <style>
      /* ==========================
         Design tokens (Dark only)
      ========================== */
      :root {
        --bg: #000000;
        --text: #f5f5f5;
        --muted: #94a3b8;
        --divider: rgba(255, 255, 255, 0.18);
      }

      /* ==========================
         Base & layout
      ========================== */
      * { box-sizing: border-box; }
      html, body { height: 100%; }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, "Segoe UI", Roboto, "Helvetica Neue", Arial,
          "Noto Sans", "Liberation Sans", sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        color: var(--text);
        background: var(--bg);
        min-height: 100svh;
        display: grid;
        place-items: center;
      }

      .container {
        width: min(940px, 92vw);
        padding: clamp(16px, 4vw, 28px);
      }

      .card { padding: clamp(20px, 4.5vw, 48px); animation: fade-in 600ms ease both; }

      /* ==========================
         Typography
      ========================== */
      .quote-zh {
        font-family: "KaiTi", "SimKai", "STKaiti", serif;
        font-size: clamp(26px, 4.2vw, 48px);
        line-height: 1.5;
        color: var(--muted);
        font-weight: 600;
        text-align: center;
        margin: clamp(10px, 2.4vw, 18px) 0 8px;
      }

      /* Extra breathing room on small screens so text wraps into exactly 2 lines */
      @media (max-width: 640px) {
        .quote-zh {
          padding: 0 12px;
        }
      }

      .quote-en {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        font-size: clamp(18px, 2.8vw, 28px);
        line-height: 1.4;
        font-weight: 600;
        letter-spacing: 0.01em;
        text-align: center;
        margin: clamp(10px, 2.4vw, 18px) 0 8px;
      }

      .divider {
        height: 1px;
        margin: clamp(12px, 2.2vw, 18px) 0;
        border-radius: 1px;
        opacity: 0.75;
        background: linear-gradient(90deg, transparent, var(--divider), transparent);
      }

      /* ==========================
         Footer & pageview count
      ========================== */
      .site-footer {
        margin-top: 1rem;
        text-align: center;
        color: var(--muted);
        font-size: 0.9rem;
      }
      #pageviews {
        font-style: normal;
        font-weight: 700;
      }

      /* ==========================
         Conditional break for Chinese line
      ========================== */
      .mobile-br { display: none; }
      @media (max-width: 640px), (max-height: 520px) {
        .mobile-br { display: inline; }
      }

      /* ==========================
         Motion
      ========================== */
      @keyframes fade-in {
        from { opacity: 0; transform: translateY(8px); }
        to   { opacity: 1; transform: translateY(0); }
      }
    </style>

    <!-- n8n chat styles (left unmodified) -->
    <link href="https://cdn.jsdelivr.net/npm/@n8n/chat/dist/style.css" rel="stylesheet" />
  </head>
  <body>
    <main class="container">
      <section class="card">
        <blockquote class="quote-zh" id="chinese">
          <span>易有太極，是生兩儀。<br class="mobile-br" />兩儀生四象，四象生八卦。</span>
        </blockquote>

        <div class="divider" role="presentation"></div>

        <blockquote class="quote-en" id="english">
          <span>From the Great Ultimate unfolds the Two Forces;</span><br />
          <span>from the Two Forces emerge the Four Phases;</span><br />
          <span>from the Four Phases evolve the Eight Patterns of change.</span>
        </blockquote>
      </section>
    </main>

    <footer class="site-footer">
      <span>
        <em id="pageviews">Loading…</em> visitors
      </span>
    </footer>

    <!-- n8n embed -->
    <script type="module">
      import { createChat } from 'https://cdn.jsdelivr.net/npm/@n8n/chat/dist/chat.bundle.es.js';

      const TOKEN_ENDPOINT = 'https://n8n.kuibin.workers.dev/api/token';
      const N8N_WEBHOOK_URL = 'https://n8n.linsnode.com/webhook/bf4dd093-bb02-472c-9454-7ab9af97bd1d';

      async function getToken() {
        const res = await fetch(TOKEN_ENDPOINT, { method: 'POST' });
        if (!res.ok) {
          const msg = await res.text().catch(() => res.statusText);
          throw new Error(`Token request failed: ${res.status} ${msg}`);
        }
        const { token } = await res.json();
        if (!token) throw new Error('No token returned');
        return token;
      }

      async function boot() {
        try {
          const token = await getToken();
          createChat({
            webhookUrl: N8N_WEBHOOK_URL,
            enableStreaming: false,
            webhookConfig: {
              method: 'POST',
              headers: {
                'Authorization': `Bearer ${token}`,
                'Content-Type': 'application/json'
              }
            }
          });
        } catch (err) {
          console.error(err);
        }
      }

      boot();
    </script>

    {% include pageviews/goatcounter.html %}
  </body>
</html>
